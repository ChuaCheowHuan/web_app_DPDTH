<h1 id="django">Django</h1>

<ul>
  <li>Django is a much heavier weight web framework than Flask with a lot more out-of-the-box features that would’ve had to be built up manually and repetitively with a micro-framework like Flask.</li>
</ul>

<h2 id="using-django">Using Django</h2>

<ul>
  <li>Django divides all of its web applications into ‘projects’, composed of different parts. To start a new project, run <code class="highlighter-rouge">django-admin startproject projectname</code>.</li>
</ul>

<h3 id="project-components">Project Components</h3>

<ul>
  <li>Django creates a number of files with a new project:
    <ul>
      <li><code class="highlighter-rouge">__init__.py</code> : defines the directory <code class="highlighter-rouge">projectname</code> as a Python ‘package’, a collection of multiple Python files
        <ul>
          <li>Django is built on the idea of packages. A web application can be made up of multiple packages, each serving a slightly different purpose, and Django will help manage these.</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">manage.py</code> : a Python script that can be used to perform useful operations on a web application</li>
      <li><code class="highlighter-rouge">settings.py</code> : basic settings, like time zone, other applications installed in the project, what sort of database is used, etc.</li>
      <li><code class="highlighter-rouge">urls.py</code> : determines what URLs/routes can be accessed when using the web application</li>
      <li><code class="highlighter-rouge">wsgi.py</code> : a file that helps to deploy an application to a web server</li>
      <li><code class="highlighter-rouge">project_name/</code> : the directory for the project that contains all of the above files by default</li>
    </ul>
  </li>
  <li>A Django project consists of one or more Django applications, or apps, which serves a particular purpose.</li>
</ul>

<h3 id="a-basic-application">A Basic Application</h3>

<ul>
  <li>To create an app, inside the project directory, run <code class="highlighter-rouge">python manage.py startapp appname</code>. This will create a directory <code class="highlighter-rouge">appname</code> inside of the project directory. <code class="highlighter-rouge">appname</code> will contain a number of files automatically.</li>
  <li>Inside of <code class="highlighter-rouge">appname</code>, <code class="highlighter-rouge">views.py</code> is analogous to <code class="highlighter-rouge">application.py</code> for a Flask application. It contains the code that determines what the user sees at a particular route.At first, it will look like this:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

  <span class="c"># Create your views here.</span>
</code></pre></div>    </div>
  </li>
  <li>All view functions should take the <code class="highlighter-rouge">request</code> object as an argument. Like in Flask, this object will contain information about what sort of arguments were passed in to the request, etc. A baisc view might just return an simple HTTP response.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
  <span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

  <span class="c"># Create your views here.</span>
  <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>That basic view, however, does not specify what route it is at. To do so, a new <code class="highlighter-rouge">urls.py</code> must be created inside the <code class="highlighter-rouge">appname</code> directory (this is a different <code class="highlighter-rouge">urls.py</code> than the project-level file of the same name). Each application will often have its own routes, and these separate <code class="highlighter-rouge">urls.py</code> help to signal that difference in functionality, keep things organized, and make apps easily reusable in other projects. <code class="highlighter-rouge">appname/urls.py</code> could look like this:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

  <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
  <span class="p">]</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">from . import views</code> imports <code class="highlighter-rouge">views.py</code> from the <code class="highlighter-rouge">appname</code> directory, so that URLs can be linked to views.</li>
  <li><code class="highlighter-rouge">urlpatterns</code> is a list of all the URLs supported by this application.</li>
  <li><code class="highlighter-rouge">""</code> indicates the empty route.</li>
  <li>When the Django project starts up, it will only check the <code class="highlighter-rouge">urls.py</code> at the project level. So, the final step before this basic application is actually usable, <code class="highlighter-rouge">appname/urls.py</code> must be linked to the project’s <code class="highlighter-rouge">urls.py</code>, which starts off with some code in it already.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
  <span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>

  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"admin/"</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)</span>
  <span class="p">]</span>
</code></pre></div>    </div>
  </li>
  <li>To link the new path, simply add the path to <code class="highlighter-rouge">urlpatterns</code>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">"appname.urls"</span><span class="p">)),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"admin/"</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)</span>
  <span class="p">]</span>
</code></pre></div>    </div>
    <ul>
      <li>The reason for this apparent complexity is to allow for routing amongst multiple different applications. This <code class="highlighter-rouge">urls.py</code> serves as the dispatch point for all those lower-level <code class="highlighter-rouge">urls.py</code> files.</li>
    </ul>
  </li>
  <li>To run the application, run <code class="highlighter-rouge">python manage.py runserver</code>.</li>
</ul>

<h2 id="flights-revisited">Flights Revisited</h2>

<ul>
  <li>To demonstrate Django more completely, the next example will reconstruct and expand upon the flight manager application that was originally built with Flask. The project name will be <code class="highlighter-rouge">djangoair</code>, and it will contain an application called <code class="highlighter-rouge">flights</code>.</li>
  <li>To start off, <code class="highlighter-rouge">flights/urls.py</code>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

  <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
  <span class="p">]</span>
</code></pre></div>    </div>
    <ul>
      <li>These urls should be linked to <code class="highlighter-rouge">djangoair/urls.py</code> in the same way as the previous example.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">flights/views.py</code>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
  <span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

  <span class="c"># Create your views here</span>
  <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">"Flights"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>This application is now at the same point as the previous example. The next step is to add the database. Django was designed for interacting with data, so it makes it very easy to do so. <code class="highlighter-rouge">flights/models.py</code> looks like this right now:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

  <span class="c"># Create your models here</span>
</code></pre></div>    </div>
    <ul>
      <li>This the file to define the classes which will define the types of data being stored in the database. The information to be contained here is very analagous to the information created with Flask-SQLAlchemy.</li>
    </ul>
  </li>
  <li>A model for a flight might look like this:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Flight</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">model</span><span class="p">):</span>
      <span class="n">origin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
      <span class="n">destination</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
      <span class="n">duration</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</code></pre></div>    </div>
    <ul>
      <li>Inherting <code class="highlighter-rouge">models.model</code> just establishes this class as a Django model.</li>
      <li>Django has a number of built-in types of fields that map to different types of data in a SQL database, for instance.</li>
    </ul>
  </li>
  <li>Now, as with new URLs, the models must be linked to the Django project. In <code class="highlighter-rouge">djangoair/settings.py</code>, there is a list called <code class="highlighter-rouge">INSTALLED_APPS</code>, pre-populated with Django’s installed apps. To add the <code class="highlighter-rouge">flights</code> app, <code class="highlighter-rouge">flights.app.FlightsConfig</code> should be added to that list.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s">'flights.apps.FlightsConfig'</span><span class="p">,</span>
      <span class="s">'django.contrib.admin'</span><span class="p">,</span>
      <span class="s">'django.contrib.auth'</span><span class="p">,</span>
      <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
      <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
      <span class="s">'django.contrib.messages'</span><span class="p">,</span>
      <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
  <span class="p">]</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">FlightsConfig</code> is the class the defines the settings for the <code class="highlighter-rouge">flights</code> application.</li>
</ul>

<h3 id="migrations">Migrations</h3>

<ul>
  <li>When building a web application, very rarely will all the tables be defined will all the correct columns from the beginning. Usually, tables are built up as the application grows, and the database will be modified. It would be tedious to change both the Django model code and run the SQL commands to modify the database.</li>
  <li>Django’s solution to this problem ‘migrations’. Django automatically detects and changes to <code class="highlighter-rouge">models.py</code> and automatically generates the necessary SQL code to make the necessary changes.</li>
  <li>To create the table for managing flights inside the database, run <code class="highlighter-rouge">python manage.py makemigrations</code>. This will look through model files for any changes and generate a ‘migration’, which represents the necessary changes for the database. Running this command will create a file <code class="highlighter-rouge">migrations/0001_initial.py</code>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c"># Generated by Django 2.0 on 2018-07-19 22:14</span>

  <span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">migrations</span><span class="p">,</span> <span class="n">models</span>

  <span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>

      <span class="n">initial</span> <span class="o">=</span> <span class="bp">True</span>

      <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">]</span>

      <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
          <span class="n">migrations</span><span class="o">.</span><span class="n">CreateModel</span><span class="p">(</span>
              <span class="n">name</span><span class="o">=</span><span class="s">'Flight'</span><span class="p">,</span>
              <span class="n">fields</span><span class="o">=</span><span class="p">[</span>
                  <span class="p">(</span><span class="s">'id'</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">AutoField</span><span class="p">(</span><span class="n">auto_created</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">serialize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s">'ID'</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s">'origin'</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s">'destination'</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s">'duration'</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()),</span>
              <span class="p">],</span>
          <span class="p">),</span>
      <span class="p">]</span>

</code></pre></div>    </div>
    <ul>
      <li>Inside the class <code class="highlighter-rouge">Migration</code> is a list <code class="highlighter-rouge">operations</code>, which contains everything that should happen to the database. In this case, the model <code class="highlighter-rouge">Flight</code> should be created, with fields <code class="highlighter-rouge">id</code>, <code class="highlighter-rouge">origin</code>, <code class="highlighter-rouge">destination</code>, and <code class="highlighter-rouge">duration</code>.</li>
      <li>Note that <code class="highlighter-rouge">id</code> was never specified in <code class="highlighter-rouge">models.py</code>. Django adds this column by default.</li>
    </ul>
  </li>
  <li>The command <code class="highlighter-rouge">python manage.py sqlmigrate flights 0001</code> will produce the SQL code that actually corresponds to this migration. This command doesn’t need to be run, but it is helpful in demonstrating what’s actually going on. The SQL command is very similar to what has been shown before, but it didn’t need to be written. It is all generated by Django’s migration system.</li>
  <li>To actually apply this migration to the database, run <code class="highlighter-rouge">python manage.py migrate</code>, which will apply the new migration as well as some default Django ones.</li>
  <li>The database that is actually being used here is defined in <code class="highlighter-rouge">djangoair/settings.py</code> in the <code class="highlighter-rouge">DATABASES</code> dictionary. By default, it uses a SQLite 3 (another version of SQL that uses a local file for a database) and the database file <code class="highlighter-rouge">db.sqlite3</code>.</li>
</ul>

<h3 id="django-shell">Django Shell</h3>

<ul>
  <li>Django provides a shell, similar to Python’s interpreter, that allows for direct modification of the database. Start the shell by running <code class="highlighter-rouge">python manage.py shell</code>. Inside the shell, Python commands can be run.</li>
  <li>To create a new flight, the following commands can be run inside the shell.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">flights.models</span> <span class="kn">import</span> <span class="n">Flight</span>

  <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="s">"New York"</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="s">"London"</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">415</span><span class="p">)</span>
  <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
  <span class="c"># Returns &lt;QuerySet [&lt;Flight: Flight object(1)&gt;]&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li><code class="highlighter-rouge">f.save()</code> is analogous to SQL’s <code class="highlighter-rouge">COMMIT</code>.</li>
      <li>A <code class="highlighter-rouge">QuerySet</code> is like a list, with added functionality.</li>
    </ul>
  </li>
  <li>The representation of the <code class="highlighter-rouge">QuerySet</code> that the shell returns isn’t really readable or helpful. To produce a more useful, string representation of a flight, a <code class="highlighter-rouge">__str__</code> function can be added to <code class="highlighter-rouge">Flight</code> class in <code class="highlighter-rouge">flights/models.py</code>.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">f</span><span class="s">"{self.id} - {self.origin} to {self.destination}"</span>
</code></pre></div>    </div>
    <ul>
      <li>For any class, not just in Django, a <code class="highlighter-rouge">__str__</code> function defines what an object should like look when printed, whether to a terminal, an HTML page, etc.</li>
    </ul>
  </li>
  <li>Back to the shell:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
  <span class="c"># Returns &lt;QuerySet [&lt;Flight: 1 - New York to London&gt;]&gt;</span>

  <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

  <span class="n">f</span>
  <span class="c"># Returns &lt;Flight: 1 - New York to London&gt;</span>

  <span class="n">f</span><span class="o">.</span><span class="n">origin</span><span class="p">()</span>
  <span class="c"># Returns 'New York'</span>

  <span class="n">f</span><span class="o">.</span><span class="nb">id</span>
  <span class="c"># Returns 1</span>

  <span class="n">f</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
  <span class="c"># Deletes the flight as expected</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="better-models">Better Models</h3>

<ul>
  <li>A more robust design for the <code class="highlighter-rouge">Flight</code> model would have an id field that links to a table of airports instead of just text for origins and destinations. To do so, a new <code class="highlighter-rouge">Airport</code> model must first be created.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Airport</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
      <span class="n">code</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
      <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

      <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
          <span class="k">return</span> <span class="n">f</span><span class="s">"{self.city} ({self.code})"</span>
</code></pre></div>    </div>
  </li>
  <li>Then, the <code class="highlighter-rouge">Flight</code> model can be modified appropriately, with origin and destination being <code class="highlighter-rouge">ForeignKey</code>s.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Flight</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
      <span class="n">origin</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Airport</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"departures"</span><span class="p">)</span>
      <span class="n">destination</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Airport</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"arrivals"</span><span class="p">)</span>
</code></pre></div>    </div>
    <ul>
      <li>Django models allow for specific behavior when an airport, for instance, is deleted. <code class="highlighter-rouge">on_delete=models.CASCADE</code> means that if an airport is deleted, all flights with that airport as an origin or destination will be deleted as well.</li>
      <li><code class="highlighter-rouge">related_name</code> allows for the accessing of all flights departing from or arriving at a particular airport, using the keys <code class="highlighter-rouge">deparatures</code> or <code class="highlighter-rouge">arrivals</code>.</li>
      <li>Note that there is no literal definitions of origin and destination as IDs, nor any actual commands for how to associate the two tables. The only things specified is that <code class="highlighter-rouge">origin</code> and <code class="highlighter-rouge">destination</code> should be <code class="highlighter-rouge">Airport</code>s. All of the work to make that happen is left to Django.</li>
    </ul>
  </li>
  <li>To apply these changes, they must be migrated in the same fashion as before. Now, in the shell, it’s a lot easier and more intuitive to create flights.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">flights.models</span> <span class="kn">import</span> <span class="n">Airport</span><span class="p">,</span> <span class="n">Flight</span>

  <span class="n">jfk</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"JFK"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"New York City"</span><span class="p">)</span>
  <span class="n">lhr</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"LHR"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"London"</span><span class="p">)</span>
  <span class="n">jfk</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
  <span class="n">lhr</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="n">jfk</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">lhr</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">415</span><span class="p">)</span>
  <span class="n">f</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="n">f</span><span class="o">.</span><span class="n">origin</span>
  <span class="c"># Returns &lt;Airport: New York City (JFK)&gt;</span>

  <span class="n">f</span><span class="o">.</span><span class="n">origin</span><span class="o">.</span><span class="n">code</span>
  <span class="c"># Returns 'JFK'</span>

  <span class="n">jfk</span><span class="o">.</span><span class="n">departures</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
  <span class="c"># Returns &lt;QuerySet [&lt;Flight: 1 - New York City (JFK) to London (LHR)&gt;]&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="rendering-templates">Rendering Templates</h3>

<ul>
  <li>Similar to Flask, in order to render an HTML template, the rendered template should be returned by the function which handles a route. For Django, that’s in <code class="highlighter-rouge">flights/views.py</code>.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/index.html"</span><span class="p">)</span>
</code></pre></div>    </div>
    <ul>
      <li>The second argument to <code class="highlighter-rouge">render</code> is simply the path to the template to be rendered.</li>
      <li>These should be stored in a path like so: <code class="highlighter-rouge">flights/templates/flights/index.html</code>. Note that <code class="highlighter-rouge">render</code> takes a path starting from the <code class="highlighter-rouge">template</code> folder. The apparent redudancy of this path, although not strictly necessary in this example, is good practice to avoid issues where multiples applications might have their own <code class="highlighter-rouge">index.html</code>.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">index.html</code> can be simple for now.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;title&gt;</span>Flights<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;h1&gt;</span>Flights<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>To display information about flights, Django’s templating system, which is very similar to Jinja, can be used. Django passes information into a template via the <code class="highlighter-rouge">context</code> dictionary.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Flight</span>

  <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
      <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">"flights"</span><span class="p">:</span> <span class="n">Flights</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/index.html"</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div>    </div>
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;h1&gt;</span>Flights<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;ul&gt;</span>
            
          {% for flight in flights %}
              <span class="nt">&lt;li&gt;</span>
                  {{ flight }}
              <span class="nt">&lt;/li&gt;</span>
          {% endfor %}
            
      <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="admin">Admin</h3>

<ul>
  <li>Admin is a built in Django app that makes it very easy to add or modify existing data on a web page. Note that this is a task that would require a good bit of code in Flask. This is perhaps one of the most powerful features of Django, especially when it comes to dealing with and manipulating data.</li>
  <li><code class="highlighter-rouge">flights/admin.py</code> starts out like this.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

  <span class="c"># Register your models here.</span>
</code></pre></div>    </div>
  </li>
  <li>Adding the <code class="highlighter-rouge">Airport</code> and <code class="highlighter-rouge">Flight</code> models is simple.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

  <span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Airpot</span><span class="p">,</span> <span class="n">Flight</span>

  <span class="c"># Register your models here.</span>
  <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Airport</span><span class="p">)</span>
  <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Flight</span><span class="p">)</span>
</code></pre></div>    </div>
    <ul>
      <li>This allows the admin app to manipulate airports and flights.</li>
    </ul>
  </li>
  <li>To access the admin site online, a user must log in. This alone is a task that would be quite tedious in Flask, but again, Django comes with this functionality built-in. The first step is to create a ‘superuser’ account with access to everything: <code class="highlighter-rouge">python manage.py createsuperuser</code>. Django will then prompt for a username, email address, and password. This data will then be entered into a users table, entirely taken care of by Django.</li>
  <li>The admin site is already linked by default in the project’s <code class="highlighter-rouge">urls.py</code> at the <code class="highlighter-rouge">admin/</code> route. On the admin site, a user can log in and manipulate the data. The admin interface is straightforward and easily navigated. Note that this admin interface isn’t meant to be used by all users of the website, but rather just content managers to dothings like populate models and add information, whearas users will view that information in a separately rendered page.</li>
</ul>

<h3 id="adding-more-routes">Adding More Routes</h3>

<ul>
  <li>To add more routes, for specific flight info, for example, the URLs just need to be added to <code class="highlighter-rouge">flights/urls.py</code> along with the corresponding view in <code class="highlighter-rouge">flights/views.py</code> and template in <code class="highlighter-rouge">templates/flights</code>.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"&lt;int:flight_id&gt;"</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">flight</span><span class="p">),</span>
  <span class="p">]</span>
</code></pre></div>    </div>
    <ul>
      <li>The syntax for creating routes that accept arguments is very similar to Flask’s.
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">Flight</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">Http404</span><span class="p">(</span><span class="s">"Flight does not exist"</span><span class="p">)</span>
  <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div>        </div>
      </li>
      <li>Because <code class="highlighter-rouge">flight_id</code> was parameter in the URL, <code class="highlighter-rouge">flight_id</code> gets passed to the <code class="highlighter-rouge">flight</code> view.</li>
      <li><code class="highlighter-rouge">pk</code> stands for ‘primary key’.</li>
      <li><code class="highlighter-rouge">DoesNotExist</code> is a special exception built into Django models.</li>
      <li><code class="highlighter-rouge">Http404</code> is another built-in Django feature (imported from <code class="highlighter-rouge">django.http</code>) that simply raises a 404 error.
  ``` html</li>
    </ul>
    <body>
        
      <h1>Flight {{ flight.id }}</h1>
      <ul>
          <li>Origin: {{ flight.origin }}</li>
          <li>Destination: {{ flight.destination }}</li>
      </ul>
  </body>

    <p>```</p>
    <ul>
      <li><code class="highlighter-rouge">head</code> contents can be the same as <code class="highlighter-rouge">index.html</code> for now. Note the current redundancy in HTML templates.</li>
    </ul>
  </li>
</ul>

<h3 id="template-inheritance">Template Inheritance</h3>

<ul>
  <li>Template inheritance for HTML pages works much the same way in Django as in Flask. Here’s what a generic template <code class="highlighter-rouge">base.html</code> could look like:
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;title&gt;</span>{% block title %}{% endblock %}<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          {% block body %}
          {% endblock %}
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
    
</code></pre></div>    </div>
  </li>
  <li>Now, <code class="highlighter-rouge">index.html</code> and <code class="highlighter-rouge">flight.html</code> can be simplified.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  {% extends "flight/base.html" %}

  {% block title %}
      Flights
  {% endblock %}

  {% body block %}
      <span class="nt">&lt;h1&gt;</span>Flights<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;uL&gt;</span>
          {% for flight in flights $}
              <span class="nt">&lt;li&gt;</span>
                  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% for flight in flights $}
              &lt;li&gt;
                  &lt;a href="</span><span class="err">{%</span> <span class="na">url</span> <span class="err">'</span><span class="na">flight</span><span class="err">'</span> <span class="na">flight</span><span class="err">.</span><span class="na">id</span> <span class="err">%}"</span><span class="nt">&gt;</span>{{ flight }}<span class="nt">&lt;/a&gt;</span>
              <span class="nt">&lt;/li&gt;</span>
          {% endfor %}
      <span class="nt">&lt;/ul&gt;</span>
  {% endblock %}
    
</code></pre></div>    </div>
    <p>and</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  {% extends "flight/base.html" %}

  {% block title %}
      Flight {{ flight.id }}
  {% endblock %}
      <span class="nt">&lt;h1&gt;</span>Flight {{ flight.id }}<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;ul&gt;</span>
          <span class="nt">&lt;li&gt;</span>Origin: {{ flight.origin }}<span class="nt">&lt;/li&gt;</span>
          <span class="nt">&lt;li&gt;</span>Destination: {{ flight.destination }}<span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'index' %}"</span><span class="nt">&gt;</span>Back to full listing<span class="nt">&lt;/a&gt;</span>
  {% block body %}

  {% endblock %}
    
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="model-relationships">Model Relationships</h3>

<ul>
  <li>Before, with Flask and SQL, in order to link passengers to flights, there was an flight ID column in the passenger table so that each passenger can be associated with a flight. The problem with this approach is that each passenger can only be on a single flight. What is more desirable is a ‘many-to-many’ relationship, in which a passenger can be on multiple flights and a flight can have multiple passengers. A common paradigm for this is to implement an ‘in-between table’, which simply has two columns, one for a passenger ID and one for a flight ID, with as many rows as are necessary. Django allows for this, but does the work of implementing the in-between table automatically.</li>
  <li>The first step is to implement a passenger model in <code class="highlighter-rouge">flights/models.py</code>.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">class</span> <span class="nc">Passenger</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
      <span class="n">first</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
      <span class="n">last</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
      <span class="n">flights</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Flight</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"passengers"</span><span class="p">)</span>

      <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
          <span class="k">return</span> <span class="n">f</span><span class="s">"{self.first} {self.last}"</span>
</code></pre></div>    </div>
    <ul>
      <li>Before, when associating two tables, <code class="highlighter-rouge">models.ForeignKey</code> was used. <code class="highlighter-rouge">models.ManyToManyField</code> allows for the desired behavior of a many-to-many relationship.</li>
      <li><code class="highlighter-rouge">blank=True</code> allows for a passenger to be be associated with no flights.</li>
      <li>Like before, <code class="highlighter-rouge">related_name</code> allows for the querying of all passengers on a given flight.</li>
    </ul>
  </li>
  <li>Updating the database as before, with <code class="highlighter-rouge">python manage.py makemigrations</code> and inspecting the SQL with <code class="highlighter-rouge">python manage.py sqlmigrate flights 0003</code> reveals code for creating a table <code class="highlighter-rouge">flights_passengers</code>, as specified, but also a table <code class="highlighter-rouge">flights_passengers_flights</code>, which was not specified, but is the in-betweent table that was automatically generated.</li>
  <li>After finishing the migration with <code class="highlighter-rouge">python manage.py migrate</code>, the shell can be used to try out these new models.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">flights.models</span> <span class="kn">import</span> <span class="n">Flight</span><span class="p">,</span> <span class="n">Passenger</span>

  <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">f</span>
  <span class="c"># Returns &lt;Flight: 1 - New York City (JFK) to London (LHR)&gt;</span>

  <span class="n">p</span> <span class="o">=</span> <span class="n">Passenger</span><span class="p">(</span><span class="n">first</span><span class="o">=</span><span class="s">"Alice"</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="s">"Adams"</span><span class="p">)</span>
  <span class="n">p</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="n">p</span><span class="o">.</span><span class="n">flights</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
  <span class="n">p</span><span class="o">.</span><span class="n">flights</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
  <span class="c"># Returns &lt;QuerySet [&lt;Flight: 1 - New York City (JFK) to London (LHR)&gt;]&gt;</span>

  <span class="n">f</span><span class="o">.</span><span class="n">passengers</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
  <span class="c"># Returns &lt;QuerySet [&lt;Passenger: Alice Adams&gt;]&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>The <code class="highlighter-rouge">flight</code> view and its corresponding HTML can be updated to now display passenger info.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
      <span class="k">try</span><span class="p">:</span>
          <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">Flight</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
          <span class="k">raise</span> <span class="n">Http404</span><span class="p">(</span><span class="s">"Flight does not exist"</span><span class="p">)</span>
      <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span><span class="p">,</span>
          <span class="s">"passengers"</span><span class="p">:</span> <span class="n">flight</span><span class="o">.</span><span class="n">passengers</span><span class="o">.</span><span class="nb">all</span><span class="p">(),</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div>    </div>
    <p>and</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="nt">&lt;h2&gt;</span>Passengers<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;ul&gt;</span>
      {% for passenger in passengers %}
          <span class="nt">&lt;li&gt;</span>{{ passenger }}<span class="nt">&lt;/li&gt;</span>
      {% empty %}
          <span class="nt">&lt;li&gt;</span>No passengers<span class="nt">&lt;/li&gt;</span>
      {% endfor %}
  <span class="nt">&lt;/ul&gt;</span>
    
</code></pre></div>    </div>
    <ul>
      <li><code class="highlighter-rouge">{% empty %}</code> executes if <code class="highlighter-rouge">passengers</code> is empty.</li>
    </ul>
  </li>
  <li>The <code class="highlighter-rouge">Passenger</code> model can also be added to admin and modified on the admin application in the same was before.</li>
</ul>

<h3 id="user-registration">User Registration</h3>

<ul>
  <li>The first step to creating a web UI for use flight registration might creating a new route, along with a corresponding view and HTML template.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"index"</span><span class="p">),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"&lt;int:flight_id&gt;"</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">flight</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"flight"</span><span class="p">),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"&lt;int:flight_id&gt;/book"</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">book</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"book"</span><span class="p">)</span>
  <span class="p">]</span>
</code></pre></div>    </div>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
      <span class="k">try</span><span class="p">:</span>
          <span class="n">passenger_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"passenger"</span><span class="p">])</span>
          <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
          <span class="n">passenger</span> <span class="o">=</span> <span class="n">Passenger</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">passenger_id</span><span class="p">)</span>
      <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/error.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="s">"No selection."</span><span class="p">})</span>
      <span class="k">except</span> <span class="n">Flight</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/error.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="s">"No flight."</span><span class="p">})</span>
      <span class="k">except</span> <span class="n">Passenger</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/error.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="s">"No passenger."</span><span class="p">})</span>
      <span class="n">passenger</span><span class="o">.</span><span class="n">flights</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flight</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">"flight"</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">flight_id</span><span class="p">,)))</span>
</code></pre></div>    </div>
    <ul>
      <li>This code is written on the assumption that the user will submit a web form via a <code class="highlighter-rouge">POST</code> request with one argument being named <code class="highlighter-rouge">passenger</code>.</li>
      <li>A <code class="highlighter-rouge">KeyError</code> will be raised if either a <code class="highlighter-rouge">POST</code> request wasn’t submitted or the <code class="highlighter-rouge">passenger</code> argument wasn’t provided, leaving no data to be extracted.</li>
      <li><code class="highlighter-rouge">flights/error.html</code> will be a new generic template to render any number of error messages.</li>
      <li><code class="highlighter-rouge">HttpResponseRedirect</code> (imported from <code class="highlighter-rouge">django.http</code>) is used to send the user to their flight page after being registered for it.</li>
      <li><code class="highlighter-rouge">reverse()</code> (imported from <code class="highlighter-rouge">django.urls</code>) returns the URL given the route name. Arguments can also be passed as a tuple.</li>
    </ul>
  </li>
  <li>Assuming that creating a passenger is a separate process from registering a passenger for a flight, when the user goes to register for a flight, they should only be able to select from created passengers. To do so, all the ‘non-passengers’ on a flight should be passed into the <code class="highlighter-rouge">flight.html</code> template.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
      <span class="k">try</span><span class="p">:</span>
          <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">Flight</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
          <span class="k">raise</span> <span class="n">Http404</span><span class="p">(</span><span class="s">"Flight does not exist"</span><span class="p">)</span>
      <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span><span class="p">,</span>
          <span class="s">"passengers"</span><span class="p">:</span> <span class="n">flight</span><span class="o">.</span><span class="n">passengers</span><span class="o">.</span><span class="nb">all</span><span class="p">(),</span>
          <span class="s">"non_passengers"</span><span class="p">:</span> <span class="n">Passenger</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">flights</span><span class="o">=</span><span class="n">flight</span><span class="p">)</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</code></pre></div>    </div>
    <ul>
      <li><code class="highlighter-rouge">Passenger.objects</code> returns all passenger objects, which can then be filtered in a variety of ways. <code class="highlighter-rouge">exclude</code> removes objects with a particular property; in this case, all passengers on the current flight are excluded.</li>
    </ul>
  </li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% if non_passengers %}
    <span class="nt">&lt;h2&gt;</span>Add a Passenger<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"{% url 'book' flight.id %}"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"passenger"</span><span class="nt">&gt;</span>
            {% for passenger in non_passengers %}
                <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"{{ passenger.id }}"</span><span class="nt">&gt;</span>{{ passenger }}<span class="nt">&lt;/option&gt;</span>
            {% endfor %}
        <span class="nt">&lt;/select&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Book Flight"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
{% else %}
    <span class="nt">&lt;div&gt;</span>No passengers to add.<span class="nt">&lt;/div&gt;</span>
{% endif %}
</code></pre></div></div>

<ul>
  <li>The enclosing <code class="highlighter-rouge">if</code> block only allows for registration if there is someone to register.</li>
  <li>Here, the <code class="highlighter-rouge">passenger</code> <code class="highlighter-rouge">select</code> element is the corresponding data that’s being sent back to the <code class="highlighter-rouge">book</code> view, and inside <code class="highlighter-rouge">passenger</code> is <code class="highlighter-rouge">passenger.id</code>, which is what is expected.</li>
</ul>

<h3 id="cross-site-request-forgery">Cross-Site Request Forgery</h3>

<ul>
  <li>Although the booking functionality looks nearly complete, when the registration form is submitted, Django will not allow the user to be redirected to their flight page, and will instead produce a 403 Forbidden error: <code class="highlighter-rouge">CSRF verification failed. Request aborted.</code> CSRF (Cross-Site Request Forgery) is a potential security vulnerability in forms whereby someone could forge where the form is coming from. Django is built in to protect these type of attacks. To allow for this nonetheless, a little bit of extra syntax must be added whenever dealing with a form in Django.</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"{% url 'book' flight.id %}"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"passenger"</span><span class="nt">&gt;</span>
        {% for passenger in non_passengers %}
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"{{ passenger.id }}"</span><span class="nt">&gt;</span>{{ passenger }}<span class="nt">&lt;/option&gt;</span>
        {% endfor %}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Book Flight"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<ul>
  <li>When the form is submitted, a CSRF token is submitted with it to allow Django to verify that is indeed the same web application is submitting the request.</li>
</ul>

<h3 id="modifying-admin">Modifying Admin</h3>

<ul>
  <li>Django’s admin interface can be extended to allow for custom behavior. Returning to the flights example, here’s how <code class="highlighter-rouge">flights/admin.py</code> could be modified.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

  <span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Airport</span><span class="p">,</span> <span class="n">Flight</span><span class="p">,</span> <span class="n">Passenger</span>

  <span class="c"># Register your models here.</span>

  <span class="k">class</span> <span class="nc">PassengerInline</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">StackedInline</span><span class="p">):</span>
      <span class="n">model</span> <span class="o">=</span> <span class="n">Passenger</span><span class="o">.</span><span class="n">flights</span><span class="o">.</span><span class="n">through</span>
      <span class="n">extra</span> <span class="o">=</span> <span class="mi">1</span>

  <span class="k">class</span> <span class="nc">FlightAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
      <span class="n">inlines</span> <span class="o">=</span> <span class="p">[</span><span class="n">PassengerInline</span><span class="p">]</span>

  <span class="k">class</span> <span class="nc">PassengerAdmin</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
      <span class="n">filter_horizontal</span> <span class="o">=</span> <span class="p">(</span><span class="s">"flights"</span><span class="p">,)</span>

  <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Airport</span><span class="p">)</span>
  <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Flight</span><span class="p">,</span> <span class="n">FlightAdmin</span><span class="p">)</span>
  <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Passenger</span><span class="p">,</span> <span class="n">PassengerAdmin</span><span class="p">)</span>
</code></pre></div>    </div>
    <p>B</p>
    <ul>
      <li>Because the <code class="highlighter-rouge">Flights</code> model does not have a reference to <code class="highlighter-rouge">Passengers</code>, managing the flights on the admin app does not allow for the addition or removal of passengers in the same way that flights can be added or removed to a passenger. This can be solved by creating the <code class="highlighter-rouge">PassengerInline</code> class, which inherits from the built-in class <code class="highlighter-rouge">StackedInline</code> that allows for the addition of new relationships between objects. <code class="highlighter-rouge">PassengerInline</code> represents the place in the UI where a flight’s passengers can be modified.</li>
      <li><code class="highlighter-rouge">Passenger.flights.through</code> refers to the in-between table linking flights and passengers. By setting <code class="highlighter-rouge">model</code> to this in-between table, that table is associated with <code class="highlighter-rouge">PassengerInline</code>.</li>
      <li><code class="highlighter-rouge">extra = 1</code> sets the number of passengers which can be edited at a time to 1.</li>
      <li><code class="highlighter-rouge">FlightAdmin</code> is a new class which inherits from <code class="highlighter-rouge">ModelAdmin</code>, and contains a special set of configurations only to be used when editing passengers. These settings are applied by passing <code class="highlighter-rouge">FlightAdmin</code> to <code class="highlighter-rouge">admin.site.regiser.</code></li>
      <li><code class="highlighter-rouge">inlines</code> contains all additional inline modification sections for the admin page, which in this case only contains <code class="highlighter-rouge">PassengerInline</code>.</li>
      <li><code class="highlighter-rouge">filter_horizontal</code> helps to manipulate what flights a passenger is on. It simply allows for an additional UI element on the admin app to make it easy to add or remove flights that a passenger is on.</li>
    </ul>
  </li>
</ul>

<h3 t="8m3s" id="static-files">Static Files</h3>

<ul>
  <li>To use external static files, like <code class="highlighter-rouge">.css</code> or <code class="highlighter-rouge">.js</code> files, some special Django syntax has to be used. A base template with static files might look like this:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% load static %}

<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>{% block title %}{% endblock %}<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"{% static 'flights/styles.css' %}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}
        {% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- `{% load static %}` allows for the use of static files.
- Any static file must have its `href` formattaed as `"{% static 'path/static.css' %}"`. - Inside of the application directory (e.g. `flights`), there should be a `static` directory containing a directory for the application which in turn contains any static files. So, the entire hierarchy would look like `flights/static/flights/styles.css`. This is exactly analogous to how templates are stored.
</code></pre></div></div>

<h2 id="login-and-authentication">Login and Authentication</h2>

<ul>
  <li>Authentication and Authorization is a built-in app designed to handle users accounts and log-in functionality. This last example features this account system in an app called <code class="highlighter-rouge">users</code>. <code class="highlighter-rouge">users/urls.py</code> looks like this:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

  <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

  <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">path</span><span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"index"</span><span class="p">),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"login"</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">login_view</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"login"</span><span class="p">),</span>
      <span class="n">path</span><span class="p">(</span><span class="s">"logout"</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">logout_view</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"logout"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">users/views.py</code>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">logout</span>
  <span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>
  <span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
  <span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>

  <span class="c"># Create your views here.</span>

  <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
      <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
          <span class="s">"user"</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/user.html"</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">login_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
      <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"username"</span><span class="p">]</span>
      <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"password"</span><span class="p">]</span>
      <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">"index"</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="s">"Invalid credentials."</span><span class="p">})</span>

  <span class="k">def</span> <span class="nf">logout_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
      <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">,</span> <span class="p">{</span><span class="s">"message"</span><span class="p">:</span> <span class="s">"Logged out."</span><span class="p">})</span>
</code></pre></div>    </div>
    <ul>
      <li><code class="highlighter-rouge">django.contrib.auth</code> is Django’s authentication package, which contains the <code class="highlighter-rouge">User</code> model, along with the functions <code class="highlighter-rouge">authenticate</code> ,<code class="highlighter-rouge">login</code>, and <code class="highlighter-rouge">logout</code>.</li>
      <li><code class="highlighter-rouge">request.user.is_authenticated</code> is <code class="highlighter-rouge">true</code> if the user has logged in. If they aren’t logged in, they are redirectd to the login page. If they are, the user is directed to their user page.</li>
      <li><code class="highlighter-rouge">login_view</code> first checks that a user exists with <code class="highlighter-rouge">authenticate</code>, which takes the user’s username and password and returns that user object.</li>
      <li><code class="highlighter-rouge">login</code> takes a user and logs them into the authentication system.</li>
      <li><code class="highlighter-rouge">logout</code> simply logs the user out.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">login.html</code>:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% block body %}
<span class="nt">&lt;h1&gt;</span>Login<span class="nt">&lt;/h1&gt;</span>
{% if message %}
    <span class="nt">&lt;div&gt;</span>
        {{ message }}
    <span class="nt">&lt;/div&gt;</span>
{% endif %}
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"{% url 'login' %}"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">type=</span><span class="s">"password"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Login"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
{% endblock %}
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">user.html</code>:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% block body %}
<span class="nt">&lt;h1&gt;</span>Hello, {{ user.first_name }}<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;ul&gt;</span>
    <span class="nt">&lt;li&gt;</span>Currently logged in as: {{ user.username }}<span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'logout' %}"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
{% endblock %}
</code></pre></div></div>

<ul>
  <li>The <code class="highlighter-rouge">User</code> contains fields such as <code class="highlighter-rouge">first_name</code>, <code class="highlighter-rouge">last_name</code>, <code class="highlighter-rouge">username</code>, etc., but can also be extended.</li>
  <li>Registering a new user entails adding a new user to the database. This can be done through the admin interface with a superuser account or using the shell:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>

  <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s">"alice"</span><span class="p">,</span> <span class="s">"alice@something.com"</span><span class="p">,</span> <span class="s">"alice12345"</span><span class="p">)</span>

  <span class="n">user</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="s">"Alice"</span>

  <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">create_user</code> takes the arguments username, e-mail, password.</li>
</ul>
